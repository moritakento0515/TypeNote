# user nginx; # 必要に応じてコメントアウト解除
events {}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    # upstream django_app { # 認証段階では不要
    #     server web:8000;
    # }

    # HTTP サーバーブロック (ポート 80) - 認証用
    server {
        listen 80;
        # ★ 自分のドメイン名に書き換えてください
        server_name www.type-note.com;
        # もし www なしも使うなら追記: server_name www.type-note.com type-note.com;

        # ★ Let's Encrypt 認証用 location ブロック (必須)
        location /.well-known/acme-challenge/ {
            # Certbot が認証ファイルを置く場所 (コンテナ内のパス)
            root /var/www/certbot;
        }

        # 認証中に他のパスにアクセスされた場合のデフォルト動作
        location / {
            return 404; # または return 200 "OK"; などでも可
        }
    }

    # --- ↓↓↓ HTTPS サーバーブロックは証明書取得までコメントアウト or 削除 ---
    # server {
    #     listen 443 ssl http2;
    #     server_name www.type-note.com;
    #     # ... (ssl_certificate など) ...
    # }
    # --- ↑↑↑ ここまで ---
}